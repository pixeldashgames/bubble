[gd_scene load_steps=11 format=3 uid="uid://d3iiik7hema8m"]

[ext_resource type="Script" path="res://scripts/interactable.gd" id="3_ewyvc"]
[ext_resource type="PackedScene" uid="uid://7popm8y0vc8t" path="res://scenes/extractor.tscn" id="4_2stya"]
[ext_resource type="Script" path="res://scripts/health.gd" id="4_5ocj3"]
[ext_resource type="Script" path="res://scripts/long_interactable.gd" id="5_wbd1c"]
[ext_resource type="Script" path="res://scripts/extractor_management.gd" id="6_41o34"]
[ext_resource type="Resource" uid="uid://bhcwmn3yhumwm" path="res://items/scrap_metal.tres" id="7_l7elh"]
[ext_resource type="PackedScene" uid="uid://bljr4gcuhu3p1" path="res://art/3d/Extractor Simple.glb" id="8_1lpn4"]
[ext_resource type="PackedScene" uid="uid://bft24jrnqj2u6" path="res://art/3d/Extractor Pro.glb" id="9_r77kg"]
[ext_resource type="PackedScene" uid="uid://jaxtf84ubvet" path="res://art/3d/minerales.glb" id="11_btlvw"]

[sub_resource type="BoxShape3D" id="BoxShape3D_1m6m3"]
size = Vector3(2.92438, 3.11768, 4.68996)

[node name="ExtractorBuilder" type="Node3D"]

[node name="Interactable" type="StaticBody3D" parent="."]
script = ExtResource("3_ewyvc")
interactable_name = "Sitio de Extractor"
input_names = Array[String](["Construir"])
info_title = "Sitio de Extractor"
info_details = "Permite construir un extractor en esta posición."

[node name="CollisionShape3D" type="CollisionShape3D" parent="Interactable"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.630585, 1.05884, 0.0125046)
shape = SubResource("BoxShape3D_1m6m3")

[node name="Health" type="Node3D" parent="Interactable"]
script = ExtResource("4_5ocj3")
team = "extractors"
max_health = 250.0
enabled = false

[node name="Extractor" parent="." instance=ExtResource("4_2stya")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.5, 0)
extraction_interval = 7000.0
extraction_amount = 10
max_scrap_storage = 50
enabled = false

[node name="LongInteractable" type="Node" parent="." node_paths=PackedStringArray("interactable")]
script = ExtResource("5_wbd1c")
interactable = NodePath("../Interactable")
cancel_input_names = Array[String](["Cancelar Construcción"])
interaction_names = Array[String](["Construyendo Extractor..."])
interaction_times = Array[float]([3000.0])
intercept_actions = Array[bool]([true])

[node name="ExtractorManagement" type="Node" parent="." node_paths=PackedStringArray("extractor_interactable", "extractor_long_interactable", "extractor", "extractor_health", "animation_players", "extractor_meshes")]
script = ExtResource("6_41o34")
scrap_resource = ExtResource("7_l7elh")
extractor_interactable = NodePath("../Interactable")
extractor_long_interactable = NodePath("../LongInteractable")
extractor = NodePath("../Extractor")
build_cost = 200
upgrade_costs = Array[int]([500, 1500, 5000])
extraction_intervals = Array[float]([5000.0, 3500.0, 2500.0])
extraction_amounts = Array[int]([20, 35, 50])
storages = Array[int]([100, 250, 500])
healths = Array[float]([500.0, 750.0, 1000.0])
extractor_health = NodePath("../Interactable/Health")
animation_players = [NodePath("../Extractor Simple/AnimationPlayer"), null]
extractor_meshes = [NodePath("../Extractor Simple"), NodePath("../Extractor Pro"), NodePath("../Extractor Pro"), NodePath("../Extractor Pro")]
interactable_name = "Extractor"
upgrade_action_name = "Mejorar"
repair_action_name = "Reparar"
collect_action_name = "Recolectar"
upgrade_interactable_name = "Mejorando Extractor..."
repair_interactable_name = "Reparando Extractor..."
upgrade_cancel_name = "Cancelar Mejora"
repair_cancel_name = "Cancelar Reparación"
upgrade_time = 10000.0
repair_time = 5000.0
repair_fraction = 0.2

[node name="Extractor Simple" parent="." instance=ExtResource("8_1lpn4")]
visible = false

[node name="Plane_037" parent="Extractor Simple" index="1"]
transform = Transform3D(-0.000468697, 0.443002, 0.0223055, -0.443562, -2.53716e-09, -0.00797683, 0.00860972, 0.0241161, -0.409743, -0.0483285, 1.00976, -1.42996)

[node name="Plane_040" parent="Extractor Simple" index="2"]
transform = Transform3D(0.320328, 0.317211, 0.00509057, 0.00876206, -3.22683e-07, -0.368525, 0.317131, -0.320409, 0.00504013, -0.0163313, 0.716596, -1.6934)

[node name="Skeleton3D" parent="Extractor Simple/Armature_015" index="0"]
bones/0/rotation = Quaternion(-0.596206, -0.376611, 0.372007, 0.603584)
bones/1/rotation = Quaternion(-0.000610744, -0.0859419, -0.00612652, 0.996281)
bones/2/rotation = Quaternion(-7.16823e-05, -0.0122608, -0.00614955, 0.999906)

[node name="Plane_004" parent="Extractor Simple/Armature_015/Skeleton3D" index="0"]
transform = Transform3D(0.99995, 0, -0.0100355, 0, 1, 0, 0.0100355, 0, 0.99995, 0, 0, 0)

[node name="Plane_006" parent="Extractor Simple/Armature_015/Skeleton3D" index="1"]
transform = Transform3D(-0.438079, 0.898894, 0.00877105, -0.898713, -0.438167, 0.0179937, 0.0200176, 0, 0.9998, 0.107726, -2.38419e-07, 0.000988781)

[node name="Plane_007" parent="Extractor Simple/Armature_015/Skeleton3D" index="2"]
transform = Transform3D(0.999695, 0, 0.0246764, 0, 1, 0, -0.0246764, 0, 0.999695, 0, 0, 0)

[node name="Extractor Pro" parent="." instance=ExtResource("9_r77kg")]
visible = false

[node name="minerales" parent="." instance=ExtResource("11_btlvw")]
transform = Transform3D(0.704591, 0, 0.624247, 0, 0.941346, 0, -0.624247, 0, 0.704591, 0.113719, 0.40131, 0.459453)

[connection signal="interact" from="Interactable" to="ExtractorManagement" method="_on_interactable_interact"]
[connection signal="death" from="Interactable/Health" to="ExtractorManagement" method="_on_health_death"]
[connection signal="revive" from="Interactable/Health" to="ExtractorManagement" method="_on_health_revive"]
[connection signal="long_interact" from="LongInteractable" to="." method="_on_long_interactable_long_interact"]
[connection signal="long_interact" from="LongInteractable" to="ExtractorManagement" method="_on_long_interactable_long_interact"]

[editable path="Extractor Simple"]
[editable path="Extractor Pro"]
